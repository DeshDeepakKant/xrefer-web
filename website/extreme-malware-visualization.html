<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XRefer - Advanced Malware Analysis</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #e0e0e0;
            font-family: monospace;
            overflow: hidden;
        }
        
        .header {
            background-color: #222;
            color: #e0e0e0;
            padding: 10px;
            border-bottom: 1px solid #444;
            display: flex;
            justify-content: space-between;
            position: relative;
            z-index: 10;
        }
        
        .title-bar {
            display: flex;
            align-items: center;
        }
        
        .nav-links {
            display: flex;
            align-items: center;
        }
        
        .nav-links span {
            margin: 0 10px;
            color: #0c0;
        }
        
        .header-btn {
            padding: 2px 8px;
            background: transparent;
            color: #e0e0e0;
            border: 1px solid #444;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 10px;
        }
        
        .content {
            display: flex;
            height: calc(100vh - 41px);
        }
        
        .info-panel {
            width: 30%;
            background-color: #222;
            padding: 15px;
            overflow-y: auto;
            border-right: 1px solid #444;
        }
        
        .binary-info {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #444;
        }
        
        .warning-box {
            background-color: #331111;
            border: 1px solid #f00;
            color: #f88;
            padding: 10px;
            margin: 15px 0;
            border-radius: 3px;
        }
        
        .cluster-info {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #444;
        }
        
        .visualization {
            flex: 1;
            background-color: #1a1a1a;
            position: relative;
            overflow: hidden;
        }
        
        .nav-panel {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background-color: rgba(34, 34, 34, 0.8);
            padding: 10px;
            border: 1px solid #444;
            border-radius: 3px;
            z-index: 5;
        }
        
        .nav-panel ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .nav-panel li {
            margin-bottom: 5px;
            color: #0f0;
        }
        
        .nav-panel li:before {
            content: "- ";
            color: #0f0;
        }
        
        pre {
            background-color: #2a2a2a;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .highlight-red {
            color: #f55;
        }
        
        .highlight-green {
            color: #5f5;
        }
        
        .highlight-blue {
            color: #55f;
        }
        
        .highlight-yellow {
            color: #ff5;
        }
        
        .highlight-cyan {
            color: #5ff;
        }
        
        .highlight-magenta {
            color: #f5f;
        }
        
        .node {
            position: absolute;
            background-color: #2a2a2a;
            border: 1px solid #4a4a4a;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 2;
        }
        
        .node.cluster {
            background-color: #253545;
            border-color: #0af;
            color: #0cf;
        }
        
        .node.function {
            background-color: #352535;
            border-color: #f0a;
            color: #f0f;
        }
        
        .node.address {
            background-color: #353525;
            border-color: #fa0;
            color: #ff0;
        }
        
        .node.selected {
            border-width: 2px;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        
        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        path {
            stroke: #4a4a4a;
            stroke-width: 1;
            fill: none;
        }
        
        #entrypoint {
            border-color: #0f0;
            background-color: #252;
        }
        
        #cross-references {
            margin-top: 15px;
        }
        
        .function-ref {
            display: flex;
            margin-bottom: 5px;
        }
        
        .address-ref {
            color: #fa0;
            width: 90px;
        }
        
        .arrow-ref {
            color: #f55;
            margin: 0 10px;
        }
        
        .artifacts-section {
            margin-top: 15px;
        }
        
        .artifacts-section h3 {
            color: #0cf;
            border-bottom: 1px solid #0af;
            padding-bottom: 5px;
        }
        
        .artifact-item {
            margin-bottom: 3px;
            display: flex;
        }
        
        .artifact-addr {
            color: #fa0;
            width: 90px;
        }
        
        .artifact-name {
            flex: 1;
        }
        
        .artifact-name.api {
            color: #5f5;
        }
        
        .artifact-name.string {
            color: #f5f;
        }
        
        .detailed-functions {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #444;
            margin-bottom: 15px;
        }
        
        .tab {
            padding: 5px 15px;
            cursor: pointer;
        }
        
        .tab.active {
            background-color: #333;
            border: 1px solid #444;
            border-bottom: none;
            border-radius: 3px 3px 0 0;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .xref-section {
            margin-top: 20px;
        }
        
        .xref-section h4 {
            color: #f55;
            margin-bottom: 5px;
        }
        
        .xref-list {
            margin-left: 20px;
        }
        
        .simplify-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="title-bar">
            <span>XRefer - Navigator</span>
        </div>
        <div class="nav-links">
            <span>[ XRefer ]</span>
            <span>[ func ea: 0x5f9360 ]</span>
            <span>[ cluster graph ]</span>
            <span>[ func_name: sub_5f9360 ]</span>
            <span>[ ESC to go back ]</span>
            <button class="header-btn">H for help</button>
        </div>
    </div>
    
    <div class="content">
        <div class="info-panel">
            <div class="binary-info">
                <h2>Binary Category: <span class="highlight-red">Ransomware</span></h2>
                <p class="highlight-green">This binary is ransomware that encrypts files using various ciphers, propagates over the network, and employs anti-analysis techniques.</p>
            </div>
            
            <div class="warning-box">
                ===> Some aspects of cluster analysis use LLM processing to enhance code relationship with semantic context. Results may be inconsistent or incomplete, and thus the analysis provided is considered low confidence. Right-click to re-run analysis if current results appear inaccurate. Always verify findings through manual inspection. <===
            </div>
            
            <div class="cluster-info">
                <h3>Cluster 0060 - Image Generation and Encoding Module</h3>
                <p class="highlight-green">Generates and encodes images in PNG format.</p>
                
                <div class="relationships">
                    <h4>Relationships:</h4>
                    <p class="highlight-green">Uses embedded-graphics and png crates for image generation, DEFLATE compression (cluster.id.0061), and PNG encoding. Handles image rendering and encoding errors.</p>
                </div>
                
                <p>Simplified graph showing 10 nodes</p>
                
                <div id="cross-references">
                    <h4>Cross-references to cluster root:</h4>
                    <div class="function-ref">
                        <span class="address-ref">sub_578480</span>
                    </div>
                    <div class="function-ref">
                        <span class="address-ref"></span>
                        <span class="arrow-ref">•</span>
                        <span>cluster.id.0001 - Ransomware Main Module</span>
                    </div>
                    <div class="function-ref">
                        <span class="address-ref"></span>
                        <span class="arrow-ref">└─</span>
                        <span class="highlight-yellow">0x57fa90</span>
                    </div>
                </div>
            </div>
            
            <div class="artifacts-section">
                <h3>Artifacts:</h3>
                
                <h4 class="highlight-green">APIs</h4>
                <div class="artifact-item">
                    <span class="artifact-name api">IsDebuggerPresent</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name api">CheckRemoteDebuggerPresent</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name api">RegCreateKeyExW</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name api">RegSetValueExW</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name api">CreateServiceW</span>
                </div>
                
                <h4 class="highlight-magenta">Strings</h4>
                <div class="artifact-item">
                    <span class="artifact-name string">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name string">BlackCat_Service</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name string">HARDWARE\\DEVICEMAP\\Scsi</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name string">VBOX</span>
                </div>
                <div class="artifact-item">
                    <span class="artifact-name string">VMware</span>
                </div>
            </div>
            
            <div class="detailed-functions">
                <div class="tabs">
                    <div class="tab active" data-tab="direct-xrefs">Direct XREFs</div>
                    <div class="tab" data-tab="indirect-xrefs">Indirect XREFs</div>
                    <div class="tab" data-tab="strings">Strings</div>
                </div>
                
                <div class="tab-content active" id="direct-xrefs">
                    <div class="xref-section">
                        <h4 class="highlight-magenta">wininet API Calls</h4>
                        <div class="xref-list">
                            <div class="artifact-item">
                                <span class="artifact-addr">0x10000078e</span>
                                <span class="artifact-name api">wininet.InternetConnectW</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000866</span>
                                <span class="artifact-name api">wininet.InternetReadFile</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x1000008a0</span>
                                <span class="artifact-name api">wininet.HttpSendRequestA</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="xref-section">
                        <h4 class="highlight-green">Network Activities</h4>
                        <div class="xref-list">
                            <div class="artifact-item">
                                <span class="artifact-addr">0x10000078e</span>
                                <span class="artifact-name">connect to HTTP server</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000866</span>
                                <span class="artifact-name">read data from Internet</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x1000007c0</span>
                                <span class="artifact-name">send HTTP request</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="indirect-xrefs">
                    <div class="xref-section">
                        <h4 class="highlight-blue">Process/Thread Operations</h4>
                        <div class="xref-list">
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name api">kernel32.ExitProcess</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name api">kernel32.TerminateProcess</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name api">kernel32.GetCurrentProcess</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="xref-section">
                        <h4 class="highlight-cyan">Memory Management</h4>
                        <div class="xref-list">
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name api">kernel32.VirtualAlloc</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name api">kernel32.VirtualProtect</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="strings">
                    <div class="xref-section">
                        <h4 class="highlight-yellow">UNCATEGORIZED</h4>
                        <div class="xref-list">
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name string">bad allocation</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name string">exit-oom</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name string">kernel32.dll</span>
                            </div>
                            <div class="artifact-item">
                                <span class="artifact-addr">0x100000867</span>
                                <span class="artifact-name string">bad array new length</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="visualization">
            <div class="simplify-toggle">
                <button class="header-btn">Show Simplified</button>
            </div>
            
            <svg id="graph-svg"></svg>
            
            <div class="node cluster" id="entrypoint" style="top: 120px; left: 50%;">
                cluster.id.0060 - 0x5b6440<br>
                Image Generation and Encoding Module
            </div>
            
            <div class="node address" style="top: 220px; left: 20%;">0x5c45f0</div>
            
            <div class="node cluster" style="top: 320px; left: 20%;">
                cluster.id.0061<br>
                DEFLATE Compression Module
            </div>
            
            <div class="node address" style="top: 220px; left: 30%;">0x507a40</div>
            <div class="node address" style="top: 220px; left: 40%;">0x5078d0</div>
            <div class="node address" style="top: 220px; left: 50%;">0x61d530</div>
            <div class="node address" style="top: 220px; left: 60%;">0x6d2fd0</div>
            <div class="node address" style="top: 220px; left: 70%;">0x6d1e10</div>
            <div class="node address" style="top: 220px; left: 80%;">0x6e81b0</div>
            <div class="node address" style="top: 220px; left: 90%;">0x5570d0</div>
            <div class="node address" style="top: 220px; left: 95%;">0x6e66c0</div>
            
            <div class="nav-panel">
                <h3>Navigation:</h3>
                <ul>
                    <li>Click cluster IDs to explore subclusters</li>
                    <li>Hover over cluster IDs to view cluster information</li>
                    <li>Hover over addresses to view function details</li>
                    <li>Double-click addresses to navigate to their location</li>
                    <li>Press G to pin graph (graph view will not disappear when navigating to a new function)</li>
                    <li>Press J to enable cluster sync (currently OFF)</li>
                    <li>Press C to toggle between cluster table and cluster graph view</li>
                    <li>ESC to navigate back</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Draw connecting lines 
            const svg = document.getElementById('graph-svg');
            const entrypoint = document.getElementById('entrypoint');
            const nodes = document.querySelectorAll('.node:not(#entrypoint)');
            
            // Get entrypoint position
            const entryRect = entrypoint.getBoundingClientRect();
            const contentRect = document.querySelector('.visualization').getBoundingClientRect();
            
            const entryX = entryRect.left + entryRect.width/2 - contentRect.left;
            const entryY = entryRect.top + entryRect.height - contentRect.top;
            
            // Draw lines from entrypoint to each node
            nodes.forEach(node => {
                const nodeRect = node.getBoundingClientRect();
                const nodeX = nodeRect.left + nodeRect.width/2 - contentRect.left;
                const nodeY = nodeRect.top - contentRect.top;
                
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', `M${entryX},${entryY} L${nodeX},${nodeY}`);
                if (node.classList.contains('cluster')) {
                    path.setAttribute('stroke', '#0af');
                }
                svg.appendChild(path);
            });
            
            // Tab switching
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Get target tab content and activate it
                    const target = this.getAttribute('data-tab');
                    document.getElementById(target).classList.add('active');
                });
            });
            
            // Node selection
            const allNodes = document.querySelectorAll('.node');
            allNodes.forEach(node => {
                node.addEventListener('click', function() {
                    allNodes.forEach(n => n.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // Toggle simplified view
            const toggleBtn = document.querySelector('.simplify-toggle button');
            toggleBtn.addEventListener('click', function() {
                if (this.textContent === 'Show Simplified') {
                    // Hide some nodes to simplify
                    document.querySelectorAll('.node.address').forEach(node => {
                        if (Math.random() > 0.4) {
                            node.style.display = 'none';
                        }
                    });
                    this.textContent = 'Show Full';
                } else {
                    // Show all nodes
                    document.querySelectorAll('.node').forEach(node => {
                        node.style.display = 'block';
                    });
                    this.textContent = 'Show Simplified';
                }
                
                // Redraw SVG
                while (svg.firstChild) {
                    svg.removeChild(svg.firstChild);
                }
                
                const visibleNodes = document.querySelectorAll('.node:not([style*="display: none"]):not(#entrypoint)');
                visibleNodes.forEach(node => {
                    const nodeRect = node.getBoundingClientRect();
                    const nodeX = nodeRect.left + nodeRect.width/2 - contentRect.left;
                    const nodeY = nodeRect.top - contentRect.top;
                    
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', `M${entryX},${entryY} L${nodeX},${nodeY}`);
                    if (node.classList.contains('cluster')) {
                        path.setAttribute('stroke', '#0af');
                    }
                    svg.appendChild(path);
                });
            });
        });
    </script>
</body>
</html> 